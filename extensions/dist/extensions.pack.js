/*
Copyright 2008 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
var geo={isnamespace_:true};if(!("map" in Array.prototype)){Array.prototype.map=function(e){var a=this.length;if(typeof e!="function"){throw new TypeError("map() requires a mapping function.")}var d=new Array(a);var c=arguments[1];for(var b=0;b<a;b++){if(b in this){d[b]=e.call(c,this[b],b,this)}}return d}}geo.Bounds=function(){if(arguments.length==1){if(arguments[0].constructor===geo.Bounds){var b=arguments[0];this.sw_=new geo.Point(b.southWestBottom());this.ne_=new geo.Point(b.northEastTop())}else{this.sw_=this.ne_=new geo.Point(arguments[0])}}else{if(arguments.length==2){var a=new geo.Point(arguments[0]);var c=new geo.Point(arguments[1]);if(!a&&!c){return}else{if(!a){a=c}else{if(!c){c=a}}}if(a.lat()>c.lat()){throw new RangeError("Bounds southwest coordinate cannot be north of the northeast coordinate")}if(a.altitude()>c.altitude()){throw new RangeError("Bounds southwest coordinate cannot be north of the northeast coordinate")}this.sw_=a;this.ne_=c}}};geo.Bounds.prototype.southWestBottom=function(){return this.sw_};geo.Bounds.prototype.sw_=null;geo.Bounds.prototype.northEastTop=function(){return this.ne_};geo.Bounds.prototype.ne_=null;geo.Bounds.prototype.crossesAntimeridian=function(){return(this.sw_.lng()>this.ne_.lng())};geo.Bounds.prototype.is3D=function(){return !this.isEmpty()&&(this.sw_.is3D()||this.ne_.is3D())};geo.Bounds.prototype.containsPoint=function(a){if(this.isEmpty()){return false}if(!(this.sw_.lat()<=a.lat()&&a.lat()<=this.ne_.lat())){return false}if(this.is3D()&&!(this.sw_.altitude()<=a.altitude()&&a.altitude()<=this.ne_.altitude())){return false}if(this.crossesAntimeridian()){return(a.lng()<=this.ne_.lng()||a.lng()>=this.sw_.lng())}else{return(this.sw_.lng()<=a.lng()&&a.lng()<=this.ne_.lng())}};geo.Bounds.lngSpan_=function(a,b){return(a>b)?(b+360-a):(b-a)};geo.Bounds.prototype.extend=function(h){if(this.containsPoint(h)){return}if(this.isEmpty()){this.sw_=this.ne_=h;return}var a=this.sw_.altitude();var f=this.ne_.altitude();if(this.is3D()){a=Math.min(this.sw_.altitude(),h.altitude());f=Math.min(this.ne_.altitude(),h.altitude())}var i=Math.min(this.sw_.lat(),h.lat());var e=Math.max(this.ne_.lat(),h.lat());var g=geo.Bounds.lngSpan_(this.sw_.lng(),h.lng());var d=geo.Bounds.lngSpan_(h.lng(),this.ne_.lng());var c=this.sw_.lng();var b=this.ne_.lng();if(g<=d){b=h.lng()}else{c=h.lng()}this.sw_=new geo.Point(i,c,a);this.ne_=new geo.Point(e,b,f)};geo.Bounds.prototype.span=function(){return{lat:(this.ne_.lat()-this.sw_.lat()),lng:geo.Bounds.lngSpan_(this.sw_.lng(),this.ne_.lng()),altitude:this.is3D()?(this.ne_.altitude()-this.sw_.altitude()):null}};geo.Bounds.prototype.isEmpty=function(){return(this.sw_==null&&this.sw_==null)};geo.Bounds.prototype.getCenter=function(){if(this.isEmpty()){return null}return new geo.Point((this.sw_.lat()+this.ne_.lat())/2,this.crossesAntimeridian()?geo.math.normalizeLng(this.sw_.lng()+geo.Bounds.lngSpan_(this.sw_.lng(),this.ne_.lng())/2):(this.sw_.lng()+this.ne_.lng())/2,(this.sw_.altitude()+this.ne_.altitude())/2)};geo.Bounds.prototype.isFullLat=function(){return(this.sw_.lat()==-90&&this.ne_.lng()==90)};geo.Bounds.prototype.isFullLng=function(){return(this.sw_.lng()==-180&&this.ne_.lng()==180)};geo.ALTITUDE_CLAMP_TO_GROUND=0;geo.ALTITUDE_RELATIVE_TO_GROUND=1;geo.ALTITUDE_ABSOLUTE=2;geo.math={isnamespace_:true};if(!("toDegrees" in Number.prototype)){Number.prototype.toDegrees=function(){return this*180/Math.PI}}if(!("toRadians" in Number.prototype)){Number.prototype.toRadians=function(){return this*Math.PI/180}}geo.math.normalizeAngle=function(a){a=a%(2*Math.PI);return a>=0?a:a+2*Math.PI};geo.math.normalizeLat=function(a){return Math.max(-90,Math.min(90,a))};geo.math.normalizeLng=function(a){if(a%360==180){return 180}a=a%360;return a<-180?a+360:a>180?a-360:a};geo.math.reverseAngle=function(a){return geo.math.normalizeAngle(a+Math.PI)};geo.math.EARTH_RADIUS=6378135;geo.math.EARTH_RADIUS_CURVATURE_AVG=6372795;geo.math.distance=function(b,a){return geo.math.EARTH_RADIUS*geo.math.angularDistance(b,a)};geo.math.angularDistance=function(g,f){var e=g.lat().toRadians();var c=f.lat().toRadians();var d=(f.lat()-g.lat()).toRadians();var b=(f.lng()-g.lng()).toRadians();var a=Math.pow(Math.sin(d/2),2)+Math.cos(e)*Math.cos(c)*Math.pow(Math.sin(b/2),2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))};geo.math.heading=function(f,d){var c=f.lat().toRadians();var b=d.lat().toRadians();var e=Math.cos(b);var a=(d.lng()-f.lng()).toRadians();return geo.math.normalizeAngle(Math.atan2(Math.sin(a)*e,Math.cos(c)*Math.sin(b)-Math.sin(c)*e*Math.cos(a))).toDegrees()};geo.math.bearing=geo.math.heading;geo.math.midpoint=function(l,i,p){if(geo.util.isUndefined(p)||p===null){p=0.5}var m=l.lat().toRadians();var j=i.lat().toRadians();var g=l.lng().toRadians();var f=i.lng().toRadians();var c=Math.cos(m);var a=Math.cos(j);var o=geo.math.angularDistance(l,i);var e=Math.sin(o);var d=Math.sin((1-p)*o)/e;var b=Math.sin(p*o)/e;var n=d*c*Math.cos(g)+b*a*Math.cos(f);var k=d*c*Math.sin(g)+b*a*Math.sin(f);var h=d*Math.sin(m)+b*Math.sin(j);return new geo.Point(Math.atan2(h,Math.sqrt(Math.pow(n,2)+Math.pow(k,2))).toDegrees(),Math.atan2(k,n).toDegrees())};geo.math.destination=function(b,i){if(!("heading" in i&&"distance" in i)){throw new TypeError("destination() requres both heading and distance options.")}var g=b.lat().toRadians();var e=Math.sin(g);var h=i.distance/geo.math.EARTH_RADIUS;var a=i.heading.toRadians();var d=Math.sin(h);var c=Math.cos(h);var f=Math.asin(e*c+Math.cos(g)*d*Math.cos(a));return new geo.Point(f.toDegrees(),Math.atan2(Math.sin(a)*d*Math.cos(f),c-e*Math.sin(f)).toDegrees()+b.lng())};geo.Path=function(){this.coords_=[];var a=null;var b;if(arguments.length==1){var d=arguments[0];if(d.constructor===geo.Path){for(b=0;b<d.numCoords();b++){this.coords_.push(new geo.Point(d.coord(b)))}}else{if(geo.util.isArray(d)){if(!d.length||geo.util.isArray(d[0])){a=d}else{a=[d]}}else{if(geo.util.isEarthAPIObject_(d)){var c=d.getType();if(c=="KmlLineString"||c=="KmlLinearRing"){var e=d.getCoordinates().getLength();for(b=0;b<e;b++){this.coords_.push(new geo.Point(d.getCoordinates().get(b)))}}else{throw new TypeError("Could not create a path from the given arguments")}}else{throw new TypeError("Could not create a path from the given arguments")}}}}else{a=arguments}if(a){for(b=0;b<a.length;b++){this.coords_.push(new geo.Point(a[b]))}}};geo.Path.prototype.coords_=null;geo.Path.prototype.toString=function(){return"["+this.coords_.map(function(a){return a.toString()}).join(", ")+"]"};geo.Path.prototype.equals=function(b){for(var a=0;a<b.numCoords();a++){if(!this.coord(a).equals(b.coord(a))){return false}}return true};geo.Path.prototype.numCoords=function(){return this.coords_.length};geo.Path.prototype.coord=function(a){return this.coords_[a]};geo.Path.prototype.prepend=function(a){this.coords_.unshift(new geo.Point(a))};geo.Path.prototype.append=function(a){this.coords_.push(new geo.Point(a))};geo.Path.prototype.insert=function(a,b){this.coords_.splice(a,0,new geo.Point(b))};geo.Path.prototype.remove=function(a){this.coords_.splice(a,1)};geo.Path.prototype.subPath=function(b,a){return this.coords_.slice(b,a)};geo.Path.prototype.distance=function(){var b=0;for(var a=0;a<this.coords_.length-1;a++){b+=this.coords_[a].distance(this.coords_[a+1])}return b};geo.Path.prototype.containsPoint=function(b){var e=false;var f=b.lat();var a=b.lng();for(var d=0;d<this.coords_.length;d++){var c=(d+1)%this.coords_.length;if(((this.coords_[d].lat()<f&&this.coords_[c].lat()>=f)||(this.coords_[c].lat()<f&&this.coords_[d].lat()>=f))&&(this.coords_[d].lng()+(f-this.coords_[d].lat())/(this.coords_[c].lat()-this.coords_[d].lat())*(this.coords_[c].lng()-this.coords_[d].lng())<a)){e=!e}}return e};geo.Path.prototype.bounds=function(){if(!this.numCoords()){return new geo.Bounds()}var b=new geo.Bounds(this.coord(0));var c=this.numCoords();for(var a=1;a<c;a++){b.extend(this.coord(a))}return b};geo.Path.prototype.area=function(){var n=0;var l=this.bounds();var e=l.southWestBottom().lng();var o=l.southWestBottom().lat();var h=this.numCoords();for(var g=0;g<h;g++){var f=(g+1)%h;var d=this.coord(g).distance(new geo.Point(this.coord(g).lat(),e));var c=this.coord(f).distance(new geo.Point(this.coord(f).lat(),e));var m=this.coord(g).distance(new geo.Point(o,this.coord(g).lng()));var k=this.coord(f).distance(new geo.Point(o,this.coord(f).lng()));n+=d*k-c*m}return Math.abs(n*0.5)};geo.Point=function(){var b=null;if(arguments.length==1){var a=arguments[0];if(a.constructor===geo.Point){this.lat_=a.lat();this.lng_=a.lng();this.altitude_=a.altitude();this.altitudeMode_=a.altitudeMode()}else{if(geo.util.isArray(a)){b=a}else{if(geo.util.isEarthAPIObject_(a)){var c=a.getType();if(c=="KmlPoint"||c=="KmlLookAt"){this.lat_=a.getLatitude();this.lng_=a.getLongitude();this.altitude_=a.getAltitude();this.altitudeMode_=a.getAltitudeMode()}else{if(c=="KmlCoord"||c=="KmlLocation"){this.lat_=a.getLatitude();this.lng_=a.getLongitude();this.altitude_=a.getAltitude()}else{throw new TypeError("Could not create a point from the given Earth object")}}}else{throw new TypeError("Could not create a point from the given arguments")}}}}else{b=arguments}if(b){this.lat_=b[0];this.lng_=b[1];if(b.length>=3){this.altitude_=b[2];if(b.length>=4){this.altitudeMode_=b[3]}}}this.lat_=geo.math.normalizeLat(this.lat_);this.lng_=geo.math.normalizeLng(this.lng_)};geo.Point.prototype.lat=function(){return this.lat_};geo.Point.prototype.lat_=0;geo.Point.prototype.lng=function(){return this.lng_};geo.Point.prototype.lng_=0;geo.Point.prototype.altitude=function(){return this.altitude_};geo.Point.prototype.altitude_=0;geo.Point.prototype.altitudeMode=function(){return this.altitudeMode_};geo.Point.prototype.altitudeMode_=geo.ALTITUDE_RELATIVE_TO_GROUND;geo.Point.prototype.toString=function(){return"("+this.lat().toString()+", "+this.lng().toString()+", "+this.altitude().toString()+")"};geo.Point.prototype.flatten=function(){return new geo.Point(this.lat(),this.lng())};geo.Point.prototype.is3D=function(){return this.altitude_!=0};geo.Point.prototype.equals=function(a){return this.lat()==a.lat()&&this.lng()==a.lng()&&this.altitude()==a.altitude()&&this.altitudeMode()==a.altitudeMode()};geo.Point.prototype.angularDistance=function(a){return geo.math.angularDistance(this,a)};geo.Point.prototype.distance=function(a){return geo.math.distance(this,a)};geo.Point.prototype.heading=function(a){return geo.math.heading(this,a)};geo.Point.prototype.midpoint=function(a,b){return geo.math.midpoint(this,a,b)};geo.Point.prototype.destination=function(a){return geo.math.destination(this,a)};geo.Polygon=function(){this.innerBoundaries_=[];var b;if(arguments.length===0){this.outerBoundary_=new geo.Path()}else{if(arguments.length==1){var d=arguments[0];if(d.constructor===geo.Polygon){this.outerBoundary_=new geo.Path(d.outerBoundary());for(b=0;b<d.innerBoundaries().length;b++){this.innerBoundaries_.push(new geo.Path(d.innerBoundaries()[b]))}}else{if(geo.util.isEarthAPIObject_(d)){var c=d.getType();if(c=="KmlLineString"||c=="KmlLinearRing"){this.outerBoundary_=new geo.Path(d)}else{if(c=="KmlPolygon"){this.outerBoundary_=new geo.Path(d.getOuterBoundary());var a=d.getInnerBoundaries().getChildNodes();var e=a.getLength();for(b=0;b<e;b++){this.innerBoundaries_.push(new geo.Path(a.item(b)))}}else{throw new TypeError("Could not create a polygon from the given arguments")}}}else{this.outerBoundary_=new geo.Path(arguments[0])}}}else{if(arguments[0].length&&typeof arguments[0][0]=="number"){this.outerBoundary_=new geo.Path(arguments)}else{if(arguments[1]){this.outerBoundary_=new geo.Path(arguments[0]);if(!geo.util.isArray(arguments[1])){throw new TypeError("Second argument to geo.Polygon constructor must be an array of paths.")}for(b=0;b<arguments[1].length;b++){this.innerBoundaries_.push(new geo.Path(arguments[1][b]))}}else{throw new Error("Cannot create a path from the given arguments.")}}}}};geo.Polygon.prototype.outerBoundary_=null;geo.Polygon.prototype.innerBoundaries_=null;geo.Polygon.prototype.toString=function(){return"Polygon: "+this.outerBoundary().toString()+(this.innerBoundaries().length?", ("+this.innerBoundaries().length+" inner boundaries)":"")};geo.Polygon.prototype.outerBoundary=function(){return this.outerBoundary_};geo.Polygon.prototype.innerBoundaries=function(){return this.innerBoundaries_};geo.Polygon.prototype.containsPoint=function(a){if(!this.outerBoundary_.containsPoint(a)){return false}for(var b=0;b<this.innerBoundaries_.length;b++){if(this.innerBoundaries_[b].containsPoint(a)){return false}}return true};geo.Polygon.prototype.area=function(){var b=this.outerBoundary_.area();for(var a=0;a<this.innerBoundaries_.length;a++){b-=this.innerBoundaries_[a].area()}return b};geo.util={isnamespace_:true};geo.util.isUndefined=function(a){return typeof a=="undefined"};geo.util.isArray=function(a){return a!==null&&typeof a=="object"&&"splice" in a&&"join" in a};geo.util.isFunction=function(a){return a!==null&&typeof a=="function"&&"call" in a&&"apply" in a};geo.util.isObjectLiteral=function(a){return a!==null&&typeof a=="object"&&a.constructor===Object&&!geo.util.isEarthAPIObject_(a)};geo.util.isEarthAPIObject_=function(a){return a!==null&&(typeof a=="function"||typeof a=="object")&&"getType" in a};
/*
Copyright 2009 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
var GEarthExtensions=function(a){var d=this;this.pluginInstance=a;function c(e,f){return function(){return e.apply(f,arguments)}}function b(e,g){for(var f in e){var h=e[f];if(geo.util.isFunction(h)){if(h.isclass_){h.extInstance_=d}else{e[f]=c(h,g)}}if(GEarthExtensions.isExtensionsNamespace_(h)){b(h,g)}}}b(this,this)};GEarthExtensions.AUTO=Infinity;GEarthExtensions.ALLOWED=null;GEarthExtensions.REQUIRED=undefined;GEarthExtensions.checkParameters=function(b,g,c){var e={};b=b||{};c=c||{};for(var f in b){if(!g&&!(f in c)){var d=[];for(var a in c){d.push(a)}throw new Error("Unexpected parameter '"+f+"'. Allowed parameters are: "+d.join(", ")+".")}e[f]=b[f]}for(f in c){if(!(f in e)){if(c[f]===GEarthExtensions.REQUIRED){throw new Error("Required parameter '"+f+"' was not passed.")}if(c[f]!=GEarthExtensions.ALLOWED&&c[f]!=GEarthExtensions.AUTO){e[f]=c[f]}}}return e};GEarthExtensions.createClass_=function(){var a=[];var c=null;if(geo.util.isArray(arguments[0])){a=arguments[0];c=arguments[1]}else{c=arguments[0]}c.isclass_=true;for(var d=0;d<a.length;d++){for(var b in a[d].prototype){c.prototype[b]=a[d].prototype[b]}}return c};GEarthExtensions.isExtensionsNamespace_=function(a){return a!==null&&typeof a=="object"&&"isnamespace_" in a&&a.isnamespace_};GEarthExtensions.isInstanceOfEarthInterface=function(a,b){return a!==null&&(typeof a=="object"||typeof a=="function")&&"getType" in a&&a.getType()==b};GEarthExtensions.prototype.dom={isnamespace_:true};GEarthExtensions.domBuilder_=function(d){if(d.apiInterface&&!geo.util.isArray(d.apiInterface)){d.apiInterface=[d.apiInterface]}var b=d.base;while(b){if("propertySpec" in b.builderParams){if(!("propertySpec" in d)){d.propertySpec=[]}for(var e in b.builderParams.propertySpec){if(!(e in d.propertySpec)){d.propertySpec[e]=b.builderParams.propertySpec[e]}}}if(!d.apiInterface){d.apiInterface=b.builderParams.apiInterface}if(!d.apiFactoryFn){d.apiFactoryFn=b.builderParams.apiFactoryFn}b=b.builderParams.base}var c={id:""};for(e in c){if(!(e in d.propertySpec)){d.propertySpec[e]=c[e]}}var a=function(){var h={};var j;if(arguments.length===0){throw new TypeError("Cannot create object without any arguments!")}else{if(arguments.length==1){for(j=0;j<d.apiInterface.length;j++){if(GEarthExtensions.isInstanceOfEarthInterface(arguments[0],d.apiInterface[j])){return arguments[0]}}var f=arguments[0];if(geo.util.isObjectLiteral(f)){h=f}else{if("defaultProperty" in d){h[d.defaultProperty]=f}else{throw new TypeError("Expected options object")}}}else{if(arguments.length==2){if("defaultProperty" in d){h=arguments[1];h[d.defaultProperty]=arguments[0]}else{throw new Error("No default property for the DOM builder")}}}}h=GEarthExtensions.checkParameters(h,false,d.propertySpec);var g=this.util.callMethod(this.pluginInstance,d.apiFactoryFn,h.id);if(!geo.util.isUndefined(d.constructor)){d.constructor.call(this,g,h)}b=d.base;while(b){if("constructor" in b.builderParams){b.builderParams.constructor.call(this,g,h)}b=b.builderParams.base}for(var k in d.propertySpec){if(d.propertySpec[k]===GEarthExtensions.AUTO&&k in h){this.util.callMethod(g,"set"+k.charAt(0).toUpperCase()+k.substr(1),h[k])}}return g};a.builderParams=d;return a};GEarthExtensions.prototype.dom.buildFeature_=GEarthExtensions.domBuilder_({propertySpec:{name:GEarthExtensions.AUTO,visibility:GEarthExtensions.AUTO,description:GEarthExtensions.AUTO,snippet:GEarthExtensions.AUTO,region:GEarthExtensions.ALLOWED},constructor:function(b,a){if(a.region){b.setRegion(this.dom.buildRegion(a.region))}}});GEarthExtensions.prototype.dom.buildPlacemark=GEarthExtensions.domBuilder_({apiInterface:"KmlPlacemark",base:GEarthExtensions.prototype.dom.buildFeature_,apiFactoryFn:"createPlacemark",propertySpec:{point:GEarthExtensions.ALLOWED,lineString:GEarthExtensions.ALLOWED,linearRing:GEarthExtensions.ALLOWED,polygon:GEarthExtensions.ALLOWED,model:GEarthExtensions.ALLOWED,geometries:GEarthExtensions.ALLOWED,altitudeMode:GEarthExtensions.ALLOWED,stockIcon:GEarthExtensions.ALLOWED,icon:GEarthExtensions.ALLOWED,style:GEarthExtensions.ALLOWED,highlightStyle:GEarthExtensions.ALLOWED},constructor:function(d,a){var b=[];if(a.point){b.push(this.dom.buildPoint(a.point))}if(a.lineString){b.push(this.dom.buildLineString(a.lineString))}if(a.linearRing){b.push(this.dom.buildLinearRing(a.linearRing))}if(a.polygon){b.push(this.dom.buildPolygon(a.polygon))}if(a.model){b.push(this.dom.buildModel(a.model))}if(a.geometries){b=b.concat(a.geometries)}if(b.length>1){d.setGeometry(this.dom.buildMultiGeometry(b))}else{if(b.length==1){d.setGeometry(b[0])}}if(a.stockIcon){a.icon=a.icon||{};a.icon.stockIcon=a.stockIcon}if(a.icon){if(!a.style){a.style={}}a.style.icon=a.icon}if("altitudeMode" in a){d.getGeometry().setAltitudeMode(a.altitudeMode)}if(a.style){if(a.highlightStyle){var c=this.pluginInstance.createStyleMap(a.id);if(typeof a.style=="string"){c.setNormalStyleUrl(a.style)}else{c.setNormalStyle(this.dom.buildStyle(a.style))}if(typeof a.highlightStyle=="string"){c.setHighlightStyleUrl(a.highlightStyle)}else{c.setHighlightStyle(this.dom.buildStyle(a.highlightStyle))}d.setStyleSelector(c)}else{if(typeof a.style=="string"){d.setStyleUrl(a.style)}else{d.setStyleSelector(this.dom.buildStyle(a.style))}}}}});GEarthExtensions.prototype.dom.buildPointPlacemark=GEarthExtensions.domBuilder_({base:GEarthExtensions.prototype.dom.buildPlacemark,defaultProperty:"point"});GEarthExtensions.prototype.dom.buildLineStringPlacemark=GEarthExtensions.domBuilder_({base:GEarthExtensions.prototype.dom.buildPlacemark,defaultProperty:"lineString"});GEarthExtensions.prototype.dom.buildPolygonPlacemark=GEarthExtensions.domBuilder_({base:GEarthExtensions.prototype.dom.buildPlacemark,defaultProperty:"polygon"});GEarthExtensions.prototype.dom.buildNetworkLink=GEarthExtensions.domBuilder_({apiInterface:"KmlNetworkLink",base:GEarthExtensions.prototype.dom.buildFeature_,apiFactoryFn:"createNetworkLink",defaultProperty:"link",propertySpec:{link:GEarthExtensions.ALLOWED,flyToView:GEarthExtensions.AUTO,refreshVisibility:GEarthExtensions.AUTO},constructor:function(b,a){if(a.link){b.setLink(this.dom.buildLink(a.link))}}});GEarthExtensions.prototype.dom.buildContainer_=GEarthExtensions.domBuilder_({base:GEarthExtensions.prototype.dom.buildFeature_,propertySpec:{children:GEarthExtensions.ALLOWED},constructor:function(c,a){if(a.children){for(var b=0;b<a.children.length;b++){c.getFeatures().appendChild(a.children[b])}}}});GEarthExtensions.prototype.dom.buildFolder=GEarthExtensions.domBuilder_({apiInterface:"KmlFolder",base:GEarthExtensions.prototype.dom.buildContainer_,apiFactoryFn:"createFolder",defaultProperty:"children"});GEarthExtensions.prototype.dom.buildDocument=GEarthExtensions.domBuilder_({apiInterface:"KmlDocument",base:GEarthExtensions.prototype.dom.buildContainer_,apiFactoryFn:"createDocument",defaultProperty:"children"});GEarthExtensions.prototype.dom.buildOverlay_=GEarthExtensions.domBuilder_({base:GEarthExtensions.prototype.dom.buildFeature_,propertySpec:{color:GEarthExtensions.ALLOWED,icon:GEarthExtensions.ALLOWED,drawOrder:GEarthExtensions.AUTO},constructor:function(c,a){if(a.color){c.getColor().set(this.util.parseColor(a.color))}if(a.icon){var b=this.pluginInstance.createIcon("");c.setIcon(b);if(typeof a.icon=="string"){b.setHref(a.icon)}}}});GEarthExtensions.prototype.dom.buildGroundOverlay=GEarthExtensions.domBuilder_({apiInterface:"KmlGroundOverlay",base:GEarthExtensions.prototype.dom.buildOverlay_,apiFactoryFn:"createGroundOverlay",defaultProperty:"icon",propertySpec:{box:GEarthExtensions.REQUIRED,altitude:GEarthExtensions.AUTO,altitudeMode:GEarthExtensions.AUTO},constructor:function(a,b){if(b.box){var c=this.pluginInstance.createLatLonBox("");c.setBox(b.box.north,b.box.south,b.box.east,b.box.west,b.box.rotation?b.box.rotation:0);a.setLatLonBox(c)}}});GEarthExtensions.prototype.dom.buildScreenOverlay=GEarthExtensions.domBuilder_({apiInterface:"KmlScreenOverlay",base:GEarthExtensions.prototype.dom.buildOverlay_,apiFactoryFn:"createScreenOverlay",defaultProperty:"icon",propertySpec:{screenXY:GEarthExtensions.REQUIRED,size:GEarthExtensions.REQUIRED,rotation:GEarthExtensions.AUTO,overlayXY:{left:0,top:0},rotationXY:GEarthExtensions.ALLOWED},constructor:function(a,b){if(this.util.areScreenOverlayXYSwapped_()){this.dom.setVec2(a.getScreenXY(),b.overlayXY);this.dom.setVec2(a.getOverlayXY(),b.screenXY)}else{this.dom.setVec2(a.getOverlayXY(),b.overlayXY);this.dom.setVec2(a.getScreenXY(),b.screenXY)}this.dom.setVec2(a.getSize(),b.size);if("rotationXY" in b){this.dom.setVec2(a.getRotationXY(),b.rotationXY)}}});(function(){var b=["Placemark","PointPlacemark","LineStringPlacemark","PolygonPlacemark","Folder","NetworkLink","GroundOverlay","Style"];for(var a=0;a<b.length;a++){GEarthExtensions.prototype.dom["add"+b[a]]=function(c){return function(){var d=this.dom["build"+c].apply(null,arguments);this.pluginInstance.getFeatures().appendChild(d);return d}}(b[a])}})();GEarthExtensions.prototype.dom.buildExtrudableGeometry_=GEarthExtensions.domBuilder_({propertySpec:{altitudeMode:GEarthExtensions.AUTO,extrude:GEarthExtensions.AUTO,tessellate:GEarthExtensions.AUTO}});GEarthExtensions.prototype.dom.buildPoint=GEarthExtensions.domBuilder_({apiInterface:"KmlPoint",base:GEarthExtensions.prototype.dom.buildExtrudableGeometry_,apiFactoryFn:"createPoint",defaultProperty:"point",propertySpec:{point:GEarthExtensions.REQUIRED},constructor:function(b,c){var a=new geo.Point(c.point);b.set(a.lat(),a.lng(),a.altitude(),("altitudeMode" in c)?c.altitudeMode:a.altitudeMode(),false,false)}});GEarthExtensions.prototype.dom.buildLineString=GEarthExtensions.domBuilder_({apiInterface:"KmlLineString",base:GEarthExtensions.prototype.dom.buildExtrudableGeometry_,apiFactoryFn:"createLineString",defaultProperty:"path",propertySpec:{path:GEarthExtensions.REQUIRED},constructor:function(c,b){var a=c.getCoordinates();var f=new geo.Path(b.path);var e=f.numCoords();for(var d=0;d<e;d++){a.pushLatLngAlt(f.coord(d).lat(),f.coord(d).lng(),f.coord(d).altitude())}}});GEarthExtensions.prototype.dom.buildLinearRing=GEarthExtensions.domBuilder_({apiInterface:"KmlLinearRing",base:GEarthExtensions.prototype.dom.buildLineString,apiFactoryFn:"createLinearRing",defaultProperty:"path",constructor:function(a,b){}});GEarthExtensions.prototype.dom.buildPolygon=GEarthExtensions.domBuilder_({apiInterface:"KmlPolygon",base:GEarthExtensions.prototype.dom.buildExtrudableGeometry_,apiFactoryFn:"createPolygon",defaultProperty:"polygon",propertySpec:{polygon:GEarthExtensions.REQUIRED},constructor:function(e,b){var d=new geo.Polygon(b.polygon);e.setOuterBoundary(this.dom.buildLinearRing(d.outerBoundary()));if(d.innerBoundaries().length){var a=d.innerBoundaries();for(var c=0;c<a.length;c++){e.getInnerBoundaries().appendChild(this.dom.buildLinearRing(a[c]))}}}});GEarthExtensions.prototype.dom.buildModel=GEarthExtensions.domBuilder_({apiInterface:"KmlModel",apiFactoryFn:"createModel",defaultProperty:"link",propertySpec:{link:GEarthExtensions.ALLOWED,location:GEarthExtensions.ALLOWED,scale:GEarthExtensions.ALLOWED,orientation:GEarthExtensions.ALLOWED},constructor:function(f,b){if(b.link){f.setLink(this.dom.buildLink(b.link))}if(b.location){var a=new geo.Point(b.location);var e=this.pluginInstance.createLocation("");e.setLatLngAlt(a.lat(),a.lng(),a.altitude());f.setLocation(e);f.setAltitudeMode(a.altitudeMode())}if(b.scale){var c=this.pluginInstance.createScale("");if(typeof b.scale=="number"){c.set(b.scale,b.scale,b.scale)}else{if(geo.util.isArray(b.scale)){c.set(b.scale[0],b.scale[1],b.scale[2])}}f.setScale(c)}if(b.orientation){var d=this.pluginInstance.createOrientation("");if("heading" in b.orientation&&"tilt" in b.orientation&&"roll" in b.orientation){d.set(b.orientation.heading,b.orientation.tilt,b.orientation.roll)}f.setOrientation(d)}}});GEarthExtensions.prototype.dom.buildMultiGeometry=GEarthExtensions.domBuilder_({apiInterface:"KmlMultiGeometry",apiFactoryFn:"createMultiGeometry",defaultProperty:"geometries",propertySpec:{geometries:GEarthExtensions.ALLOWED},constructor:function(b,c){var a=b.getGeometries();if(geo.util.isArray(c.geometries)){for(var d=0;d<c.geometries.length;d++){a.appendChild(c.geometries[d])}}}});GEarthExtensions.prototype.dom.buildLink=GEarthExtensions.domBuilder_({apiInterface:"KmlLink",apiFactoryFn:"createLink",defaultProperty:"href",propertySpec:{href:GEarthExtensions.AUTO,refreshMode:GEarthExtensions.AUTO,refreshInterval:GEarthExtensions.AUTO,viewRefreshMode:GEarthExtensions.AUTO,viewBoundScale:GEarthExtensions.AUTO}});GEarthExtensions.prototype.dom.buildRegion=GEarthExtensions.domBuilder_({apiInterface:"KmlRegion",apiFactoryFn:"createRegion",propertySpec:{box:GEarthExtensions.REQUIRED,lod:GEarthExtensions.ALLOWED},constructor:function(d,b){var c=this.pluginInstance.createLatLonAltBox("");if(b.box.center&&b.box.span){if(!geo.util.isArray(b.box.span)&&typeof b.box.span==="number"){b.box.span=[b.box.span,b.box.span]}var a=new geo.Point(b.box.center);b.box.north=a.lat()+b.box.span[0]/2;b.box.south=a.lat()-b.box.span[0]/2;b.box.east=a.lng()+b.box.span[1]/2;b.box.west=a.lng()-b.box.span[1]/2}c.setAltBox(b.box.north,b.box.south,b.box.east,b.box.west,b.box.rotation||0,b.box.minAltitude||0,b.box.maxAltitude||0,b.box.altitudeMode||this.pluginInstance.ALTITUDE_CLAMP_TO_GROUND);var e=this.pluginInstance.createLod("");e.set(-1,-1,0,0);if(b.lod&&geo.util.isArray(b.lod)){if(b.lod.length==2){e.set(b.lod[0],b.lod[1],0,0)}else{if(b.lod.length==4){e.set(b.lod[0],b.lod[3],b.lod[1],b.lod[2])}else{}}}d.setLatLonAltBox(c);d.setLod(e)}});GEarthExtensions.prototype.dom.buildStyle=GEarthExtensions.domBuilder_({apiInterface:["KmlStyle","KmlStyleMap"],apiFactoryFn:"createStyle",propertySpec:{icon:GEarthExtensions.ALLOWED,label:GEarthExtensions.ALLOWED,line:GEarthExtensions.ALLOWED,poly:GEarthExtensions.ALLOWED},constructor:function(a,k){var j=function(l){return((l.length<2)?"0":"")+l};var g=this;var c=function(l,m){l=l?g.util.parseColor(l):"ffffffff";if(!geo.util.isUndefined(m)){l=j(Math.floor(255*m).toString(16))+l.substring(2)}return l};if(k.icon){var e=a.getIconStyle();if(typeof k.icon=="string"){k.icon={href:k.icon}}var h=this.pluginInstance.createIcon("");e.setIcon(h);if("href" in k.icon){h.setHref(k.icon.href)}else{if("stockIcon" in k.icon){h.setHref("http://maps.google.com/mapfiles/kml/"+k.icon.stockIcon+".png")}else{h.setHref("http://maps.google.com/mapfiles/kml/paddle/wht-blank.png");e.getHotSpot().set(0.5,this.pluginInstance.UNITS_FRACTION,0,this.pluginInstance.UNITS_FRACTION)}}if("scale" in k.icon){e.setScale(k.icon.scale)}if("heading" in k.icon){e.setHeading(k.icon.heading)}if("color" in k.icon||"opacity" in k.icon){k.icon.color=c(k.icon.color,k.icon.opacity);e.getColor().set(k.icon.color)}if("opacity" in k.icon){if(!("color" in k.icon)){k.icon.color="ffffffff"}k.icon.color=j(k.icon.opacity.toString(16))+k.icon.color.substring(2)}if("hotSpot" in k.icon){this.dom.setVec2(e.getHotSpot(),k.icon.hotSpot)}}if(k.label){var f=a.getLabelStyle();if(typeof k.label=="string"){k.label={color:k.label}}if("scale" in k.label){f.setScale(k.label.scale)}if("color" in k.label||"opacity" in k.label){k.label.color=c(k.label.color,k.label.opacity);f.getColor().set(k.label.color)}}if(k.line){var d=a.getLineStyle();if(typeof k.line=="string"){k.line={color:k.line}}if("width" in k.line){d.setWidth(k.line.width)}if("color" in k.line||"opacity" in k.line){k.line.color=c(k.line.color,k.line.opacity);d.getColor().set(k.line.color)}}if(k.poly){var b=a.getPolyStyle();if(typeof k.poly=="string"){k.poly={color:k.poly}}if("fill" in k.poly){b.setFill(k.poly.fill)}if("outline" in k.poly){b.setOutline(k.poly.outline)}if("color" in k.poly||"opacity" in k.poly){k.poly.color=c(k.poly.color,k.poly.opacity);b.getColor().set(k.poly.color)}}}});GEarthExtensions.prototype.dom.clearFeatures=function(){var a=this.pluginInstance.getFeatures();var b;while((b=a.getLastChild())!==null){a.removeChild(b)}};GEarthExtensions.prototype.dom.walk=function(){var a;if(arguments.length==1){if(geo.util.isObjectLiteral(arguments[0])){a=arguments[0]}else{if(geo.util.isFunction(arguments[0])){a={visitCallback:arguments[0]}}else{throw new TypeError("walk requires a visit callback function or options literal as a first parameter")}}}else{throw new Error("walk takes at most 1 arguments")}if(!("visitCallback" in a)){throw new Error("walk requires a visit callback function")}if(!("features" in a)){a.features=true}if(!("geometries" in a)){a.geometries=false}if(!("rootObject" in a)){a.rootObject=this.pluginInstance}var b=function(e,d){var k={current:d,child:d,walkChildren:true};var f=a.visitCallback.call(e,k);if(!f&&!geo.util.isUndefined(f)){return false}if(!k.walkChildren){return true}var j=null;if("getFeatures" in e){if(a.features){j=e.getFeatures()}}else{if("getGeometry" in e){if(a.geometries&&e.getGeometry()){b(e.getGeometry(),k.child)}}else{if("getGeometries" in e){if(a.geometries){j=e.getGeometries()}}else{if("getInnerBoundaries" in e){if(a.geometries){j=e.getInnerBoundaries()}}}}}if(j&&j.hasChildNodes()){var l=j.getChildNodes();var h=l.getLength();for(var g=0;g<h;g++){var c=l.item(g);if(!b(c,k.child)){return false}}}return true};if(a.rootObject){b(a.rootObject,a.rootContext)}};GEarthExtensions.prototype.dom.getObjectById=function(c,b){b=GEarthExtensions.checkParameters(b,false,{recursive:true,root:this.pluginInstance});if("getId" in b.root&&b.root.getId()==c){return b.root}var a=null;this.dom.walk({rootObject:b.root,features:true,geometries:true,visitCallback:function(){if(this.getId()==c){a=this;return false}}});return a};GEarthExtensions.prototype.dom.removeObject=function(a){var b=a.getParentNode();var c=null;if("getFeatures" in b){c=b.getFeatures()}else{if("getGeometries" in b){c=b.getGeometries()}else{if("getInnerBoundaries" in b){c=b.getInnerBoundaries()}}}c.removeChild(a)};GEarthExtensions.prototype.dom.setVec2=function(d,c){c=GEarthExtensions.checkParameters(c,false,{left:GEarthExtensions.ALLOWED,top:GEarthExtensions.ALLOWED,right:GEarthExtensions.ALLOWED,bottom:GEarthExtensions.ALLOWED,width:GEarthExtensions.ALLOWED,height:GEarthExtensions.ALLOWED});if("width" in c){c.left=c.width}if("height" in c){c.bottom=c.height}var b=0;var a=this.pluginInstance.UNITS_PIXELS;var f=0;var e=this.pluginInstance.UNITS_PIXELS;if("left" in c){if(typeof c.left=="number"){b=c.left}else{if(typeof c.left=="string"&&c.left.charAt(c.left.length-1)=="%"){b=parseFloat(c.left)/100;a=this.pluginInstance.UNITS_FRACTION}else{throw new TypeError("left must be a number or string indicating a percentage")}}}else{if("right" in c){if(typeof c.right=="number"){b=c.right;a=this.pluginInstance.UNITS_INSET_PIXELS}else{if(typeof c.right=="string"&&c.right.charAt(c.right.length-1)=="%"){b=1-parseFloat(c.right)/100;a=this.pluginInstance.UNITS_FRACTION}else{throw new TypeError("right must be a number or string indicating a percentage")}}}}if("bottom" in c){if(typeof c.bottom=="number"){f=c.bottom}else{if(typeof c.bottom=="string"&&c.bottom.charAt(c.bottom.length-1)=="%"){f=parseFloat(c.bottom)/100;e=this.pluginInstance.UNITS_FRACTION}else{throw new TypeError("bottom must be a number or string indicating a percentage")}}}else{if("top" in c){if(typeof c.top=="number"){f=c.top;e=this.pluginInstance.UNITS_INSET_PIXELS}else{if(typeof c.top=="string"&&c.top.charAt(c.top.length-1)=="%"){f=1-parseFloat(c.top)/100;e=this.pluginInstance.UNITS_FRACTION}else{throw new TypeError("top must be a number or string indicating a percentage")}}}}d.set(b,a,f,e)};GEarthExtensions.prototype.dom.buildLookAt=GEarthExtensions.domBuilder_({apiInterface:"KmlLookAt",apiFactoryFn:"createLookAt",defaultProperty:"point",propertySpec:{copy:GEarthExtensions.ALLOWED,point:GEarthExtensions.REQUIRED,heading:GEarthExtensions.ALLOWED,tilt:GEarthExtensions.ALLOWED,range:GEarthExtensions.ALLOWED},constructor:function(c,b){var a=new geo.Point(b.point);var e={heading:0,tilt:0,range:1000};if(b.copy){var d=this.util.getLookAt(e.altitudeMode);e.heading=d.getHeading();e.tilt=d.getTilt();e.range=d.getRange()}b=GEarthExtensions.checkParameters(b,true,e);c.set(a.lat(),a.lng(),a.altitude(),a.altitudeMode(),b.heading,b.tilt,b.range)}});GEarthExtensions.prototype.dom.buildCamera=GEarthExtensions.domBuilder_({apiInterface:"KmlCamera",apiFactoryFn:"createCamera",defaultProperty:"point",propertySpec:{copy:GEarthExtensions.ALLOWED,point:GEarthExtensions.REQUIRED,heading:GEarthExtensions.ALLOWED,tilt:GEarthExtensions.ALLOWED,roll:GEarthExtensions.ALLOWED},constructor:function(d,c){var a=new geo.Point(c.point);var e={heading:0,tilt:0,roll:0};if(c.copy){var b=this.util.getCamera(e.altitudeMode);e.heading=b.getHeading();e.tilt=b.getTilt();e.roll=b.getRoll()}c=GEarthExtensions.checkParameters(c,true,e);d.set(a.lat(),a.lng(),a.altitude(),a.altitudeMode(),c.heading,c.tilt,c.roll)}});GEarthExtensions.prototype.edit={isnamespace_:true};(function(){var d=null;var c="_GEarthExtensions_dragData";function a(h,g,f,k){var j=h.util.getJsDataValue(g,c)||{};d={placemark:g,draggableOptions:j.draggableOptions,dragged:false}}function e(f){return function(j){if(d){j.preventDefault();if(!j.getDidHitGlobe()){return}if(!d.dragged){d.dragged=true;if(d.draggableOptions.bounce){f.fx.cancel(d.placemark);f.fx.bounce(d.placemark,{phase:1})}if(d.draggableOptions.draggingStyle){d.oldStyle=d.placemark.getStyleSelector();d.placemark.setStyleSelector(d.draggableOptions.draggingStyle)}if(d.draggableOptions.targetScreenOverlay){var h=f.dom.buildScreenOverlay(d.draggableOptions.targetScreenOverlay);f.pluginInstance.getFeatures().appendChild(h);d.activeTargetScreenOverlay=h}}if(d.activeTargetScreenOverlay){f.dom.setVec2(f.util.areScreenOverlayXYSwapped_()?d.activeTargetScreenOverlay.getOverlayXY():d.activeTargetScreenOverlay.getScreenXY(),{left:j.getClientX(),top:j.getClientY()})}var g=d.placemark.getGeometry();g.setLatitude(j.getLatitude());g.setLongitude(j.getLongitude());if(d.draggableOptions.dragCallback){d.draggableOptions.dragCallback.call(d.placemark)}}}}function b(f,g){if(d){if(d.dragged){if(d.oldStyle){d.placemark.setStyleSelector(d.oldStyle);delete d.oldStyle}if(d.activeTargetScreenOverlay){f.pluginInstance.getFeatures().removeChild(d.activeTargetScreenOverlay);delete d.activeTargetScreenOverlay}if(d.draggableOptions.bounce){f.fx.cancel(d.placemark);f.fx.bounce(d.placemark,{startAltitude:0,phase:2,repeat:1,dampen:0.3})}}if(d.dragged&&d.draggableOptions.dropCallback&&!g){d.draggableOptions.dropCallback.call(d.placemark)}d=null}}GEarthExtensions.prototype.edit.makeDraggable=function(j,h){this.edit.endDraggable(j);h=GEarthExtensions.checkParameters(h,false,{bounce:true,dragCallback:GEarthExtensions.ALLOWED,dropCallback:GEarthExtensions.ALLOWED,draggingStyle:GEarthExtensions.ALLOWED,targetScreenOverlay:GEarthExtensions.ALLOWED});var k=this;var g=e(k);var l;l=function(m){if(d&&m.getButton()==0){google.earth.removeEventListener(k.pluginInstance.getWindow(),"mousemove",g);google.earth.removeEventListener(k.pluginInstance.getWindow(),"mouseup",l);if(d.dragged){m.preventDefault()}b(k)}};var f=function(m){if(m.getButton()==0){a(k,m.getTarget(),m.getClientX(),m.getClientY());google.earth.addEventListener(k.pluginInstance.getWindow(),"mousemove",g);google.earth.addEventListener(k.pluginInstance.getWindow(),"mouseup",l)}};this.util.setJsDataValue(j,c,{draggableOptions:h,abortAndEndFn:function(){if(d&&d.placemark.equals(j)){google.earth.removeEventListener(k.pluginInstance.getWindow(),"mousemove",g);google.earth.removeEventListener(k.pluginInstance.getWindow(),"mouseup",l);b(k,true)}google.earth.removeEventListener(j,"mousedown",f)}});google.earth.addEventListener(j,"mousedown",f)};GEarthExtensions.prototype.edit.endDraggable=function(f){var g=this.util.getJsDataValue(f,c);if(g){g.abortAndEndFn.call(null);this.util.clearJsDataValue(f,c)}};GEarthExtensions.prototype.edit.place=function(j,h){h=GEarthExtensions.checkParameters(h,false,{bounce:true,dragCallback:GEarthExtensions.ALLOWED,dropCallback:GEarthExtensions.ALLOWED,draggingStyle:GEarthExtensions.ALLOWED,targetScreenOverlay:GEarthExtensions.ALLOWED});var k=this;var g=e(k);var f;f=function(l){if(d&&l.getButton()==0){l.preventDefault();l.stopPropagation();google.earth.removeEventListener(k.pluginInstance.getWindow(),"mousemove",g);google.earth.removeEventListener(k.pluginInstance.getWindow(),"mousedown",f);b(k)}};this.util.setJsDataValue(j,c,{draggableOptions:h,abortAndEndFn:function(){if(d&&d.placemark.equals(j)){google.earth.removeEventListener(k.pluginInstance.getWindow(),"mousemove",g);google.earth.removeEventListener(k.pluginInstance.getWindow(),"mousedown",f);b(k,true)}}});a(k,j,-999,-999);google.earth.addEventListener(k.pluginInstance.getWindow(),"mousemove",g);google.earth.addEventListener(k.pluginInstance.getWindow(),"mousedown",f)}}());(function(){var a="_GEarthExtensions_lineStringEditData";GEarthExtensions.prototype.edit.drawLineString=function(h,p){p=GEarthExtensions.checkParameters(p,false,{bounce:true,finishCallback:GEarthExtensions.ALLOWED});var f=this.util.getJsDataValue(h,a)||{};if(f){this.edit.endEditLineString(h)}var j=this;var g=false;var k=[];var e=h.getAltitudeMode();var n=null;var m=(h.getType()=="KmlLinearRing");var l=h.getCoordinates();var o=this.pluginInstance.parseKml('<Document><Style id="_GEarthExtensions_regularCoordinate"><IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/shapes/placemark_circle.png</href></Icon></IconStyle></Style><Style id="_GEarthExtensions_firstCoordinateHighlight"><IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/shapes/placemark_circle.png</href></Icon><scale>1.3</scale><color>ff00ff00</color></IconStyle></Style><StyleMap id="_GEarthExtensions_firstCoordinate"><Pair><key>normal</key><styleUrl>#_GEarthExtensions_regularCoordinate</styleUrl></Pair><Pair><key>highlight</key><styleUrl>#_GEarthExtensions_firstCoordinateHighlight</styleUrl></Pair></StyleMap></Document>');var d=function(t){var s=l.getLength();if(s){var r=l.get(0);var q=l.get(s-1);if(m&&(r.getLatitude()!=q.getLatitude()||r.getLongitude()!=q.getLongitude())){l.pushLatLngAlt(r.getLatitude(),r.getLongitude(),r.getAltitude())}}j.edit.endDraggable(n);j.dom.removeObject(o);j.util.clearJsDataValue(h,a);k=[];g=true;if(p.finishCallback&&!t){p.finishCallback.call(null)}};var b=function(q){q.preventDefault();d.call(null)};var c;c=function(){n=j.dom.buildPointPlacemark([0,0],{altitudeMode:e,style:"#_GEarthExtensions_regularCoordinate"});o.getFeatures().appendChild(n);k.push(n);j.edit.place(n,{bounce:p.bounce,dropCallback:function(){if(!g){l.pushLatLngAlt(n.getGeometry().getLatitude(),n.getGeometry().getLongitude(),0);if(k.length==1){k[0].setStyleUrl("#_GEarthExtensions_firstCoordinate");google.earth.addEventListener(k[0],"mousedown",b)}setTimeout(c,0)}}})};c.call(null);google.earth.addEventListener(j.pluginInstance.getWindow(),"dblclick",b);this.pluginInstance.getFeatures().appendChild(o);this.util.setJsDataValue(h,a,{abortAndEndFn:function(){d.call(null,true);google.earth.removeEventListener(j.pluginInstance.getWindow(),"dblclick",b)}})};GEarthExtensions.prototype.edit.editLineString=function(h,q){q=GEarthExtensions.checkParameters(q,false,{editCallback:GEarthExtensions.ALLOWED});var g=this.util.getJsDataValue(h,a)||{};if(g){this.edit.endEditLineString(h)}var k=this;var o=(h.getType()=="KmlLinearRing");var c=h.getAltitudeMode();var l=h.getCoordinates();var j=l.getLength();var p=this.pluginInstance.parseKml('<Document><Style id="_GEarthExtensions_regularCoordinate"><IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/shapes/placemark_circle.png</href></Icon></IconStyle></Style><StyleMap id="_GEarthExtensions_midCoordinate"><Pair><key>normal</key><Style><IconStyle><Icon><href>http://maps.google.com/mapfiles/kml/shapes/placemark_circle.png</href></Icon><color>60ffffff</color><scale>0.75</scale></IconStyle></Style></Pair><Pair><key>highlight</key><styleUrl>#_GEarthExtensions_regularCoordinate</styleUrl></Pair></StyleMap></Document>');if(j>=2){var n=l.get(0);var m=l.get(j-1);if(o&&n.getLatitude()==m.getLatitude()&&n.getLongitude()==m.getLongitude()&&n.getAltitude()==m.getAltitude()){l.pop();j--}}var f=[];var d=function(r){return function(t){t.preventDefault();for(i=r.index;i<j-1;i++){l.set(i,l.get(i+1))}l.pop();var u=null;if(r.index>0||o){var s=r.index-1;if(s<0){s+=j}u=f[s]}j--;if(r.rightMidPlacemark==null&&u){k.edit.endDraggable(u.rightMidPlacemark);k.dom.removeObject(u.rightMidPlacemark);u.rightMidPlacemark=null}if(r.rightMidPlacemark){k.edit.endDraggable(r.rightMidPlacemark);k.dom.removeObject(r.rightMidPlacemark)}k.edit.endDraggable(r.regularPlacemark);google.earth.removeEventListener(r.regularPlacemark,"dblclick",r.deleteEventListener);k.dom.removeObject(r.regularPlacemark);f.splice(r.index,1);for(i=0;i<j;i++){f[i].index=i}if(u){u.regularDragCallback.call(u.regularPlacemark,u)}if(q.editCallback){q.editCallback(null)}}};var e=function(r){return function(){l.setLatLngAlt(r.index,this.getGeometry().getLatitude(),this.getGeometry().getLongitude(),0);var s=l.get(r.index);if(r.index>0||o){var t=r.index-1;if(t<0){t+=j}var u=new geo.Point(l.get(t)).midpoint(new geo.Point(s));f[t].rightMidPlacemark.getGeometry().setLatitude(u.lat());f[t].rightMidPlacemark.getGeometry().setLongitude(u.lng())}if(r.index<j-1||o){var v=new geo.Point(s).midpoint(new geo.Point(l.get((r.index+1)%j)));r.rightMidPlacemark.getGeometry().setLatitude(v.lat());r.rightMidPlacemark.getGeometry().setLongitude(v.lng())}if(q.editCallback){q.editCallback(null)}}};var b=function(r){var s=false;var t=null;return function(){if(!s){s=true;var u;this.setStyleUrl("#_GEarthExtensions_regularCoordinate");l.push(l.get(j-1));for(u=j-1;u>r.index+1;u--){l.set(u,l.get(u-1))}j++;t={};t.index=r.index+1;t.regularPlacemark=this;r.rightMidPlacemark=k.dom.buildPointPlacemark({point:l.get(r.index),altitudeMode:c,style:"#_GEarthExtensions_midCoordinate"});p.getFeatures().appendChild(r.rightMidPlacemark);k.edit.makeDraggable(r.rightMidPlacemark,{bounce:false,dragCallback:b(r)});t.rightMidPlacemark=k.dom.buildPointPlacemark({point:l.get(r.index),altitudeMode:c,style:"#_GEarthExtensions_midCoordinate"});p.getFeatures().appendChild(t.rightMidPlacemark);k.edit.makeDraggable(t.rightMidPlacemark,{bounce:false,dragCallback:b(t)});t.deleteEventListener=d(t);google.earth.addEventListener(this,"dblclick",t.deleteEventListener);t.regularDragCallback=e(t);f.splice(t.index,0,t);for(u=0;u<j;u++){f[u].index=u}}t.regularDragCallback.call(this,t)}};k.util.batchExecute(function(){for(var t=0;t<j;t++){var r=l.get(t);var u=l.get((t+1)%j);var s={};f.push(s);s.index=t;s.regularPlacemark=k.dom.buildPointPlacemark(r,{altitudeMode:c,style:"#_GEarthExtensions_regularCoordinate"});p.getFeatures().appendChild(s.regularPlacemark);s.regularDragCallback=e(s);k.edit.makeDraggable(s.regularPlacemark,{bounce:false,dragCallback:s.regularDragCallback});s.deleteEventListener=d(s);google.earth.addEventListener(s.regularPlacemark,"dblclick",s.deleteEventListener);if(t<j-1||o){s.rightMidPlacemark=k.dom.buildPointPlacemark({point:new geo.Point(r).midpoint(new geo.Point(u)),altitudeMode:c,style:"#_GEarthExtensions_midCoordinate"});p.getFeatures().appendChild(s.rightMidPlacemark);k.edit.makeDraggable(s.rightMidPlacemark,{bounce:false,dragCallback:b(s)})}}k.pluginInstance.getFeatures().appendChild(p)});k.util.setJsDataValue(h,a,{innerDoc:p,abortAndEndFn:function(){k.util.batchExecute(function(){var u=l.getLength();if(u){var t=l.get(0);var r=l.get(u-1);if(o&&(t.getLatitude()!=r.getLatitude()||t.getLongitude()!=r.getLongitude())){l.pushLatLngAlt(t.getLatitude(),t.getLongitude(),t.getAltitude())}}for(var s=0;s<f.length;s++){google.earth.removeEventListener(f[s].regularPlacemark,"dblclick",f[s].deleteEventListener);k.edit.endDraggable(f[s].regularPlacemark);if(f[s].rightMidPlacemark){k.edit.endDraggable(f[s].rightMidPlacemark)}}k.dom.removeObject(p)})}})};GEarthExtensions.prototype.edit.endEditLineString=function(c){var b=this.util.getJsDataValue(c,a);if(b){b.abortAndEndFn.call(null);this.util.clearJsDataValue(c,a)}}})();GEarthExtensions.prototype.fx={isnamespace_:true};GEarthExtensions.prototype.fx.getAnimationManager_=function(){if(!this.animationManager_){this.animationManager_=new this.fx.AnimationManager_(this)}return this.animationManager_};GEarthExtensions.prototype.fx.AnimationManager_=GEarthExtensions.createClass_(function(a){this.extInstance=a;this.animations_=[];this.running_=false;this.globalTime_=0});GEarthExtensions.prototype.fx.AnimationManager_.prototype.startAnimation=function(a){this.animations_.push({obj:a,startGlobalTime:this.globalTime_});this.start_()};GEarthExtensions.prototype.fx.AnimationManager_.prototype.stopAnimation=function(b){for(var a=0;a<this.animations_.length;a++){if(this.animations_[a].obj==b){this.animations_.splice(a,1);return}}};GEarthExtensions.prototype.fx.AnimationManager_.prototype.start_=function(){if(this.running_){return}this.startTimeStamp_=Number(new Date());this.tick_();for(var a=0;a<this.animations_.length;a++){this.animations_[a].obj.renderFrame(0)}var b=this;this.frameendListener_=function(){b.tick_()};this.tickInterval_=window.setInterval(this.frameendListener_,100);google.earth.addEventListener(this.extInstance.pluginInstance,"frameend",this.frameendListener_);this.running_=true};GEarthExtensions.prototype.fx.AnimationManager_.prototype.stop_=function(){if(!this.running_){return}google.earth.removeEventListener(this.extInstance.pluginInstance,"frameend",this.frameendListener_);this.frameendListener_=null;window.clearInterval(this.tickInterval_);this.tickInterval_=null;this.running_=false;this.globalTime_=0};GEarthExtensions.prototype.fx.AnimationManager_.prototype.tick_=function(){if(!this.running_){return}this.globalTime_=Number(new Date())-this.startTimeStamp_;this.renderCurrentFrame_()};GEarthExtensions.prototype.fx.AnimationManager_.prototype.renderCurrentFrame_=function(){for(var a=this.animations_.length-1;a>=0;a--){var b=this.animations_[a];b.obj.renderFrame(this.globalTime_-b.startGlobalTime)}if(this.animations_.length===0){this.stop_()}};GEarthExtensions.prototype.fx.Animation=GEarthExtensions.createClass_(function(b,a){this.extInstance=arguments.callee.extInstance_;this.renderFn=b;this.completionFn=a});GEarthExtensions.prototype.fx.Animation.prototype.start=function(){this.extInstance.fx.getAnimationManager_().startAnimation(this)};GEarthExtensions.prototype.fx.Animation.prototype.stop=function(a){this.extInstance.fx.getAnimationManager_().stopAnimation(this);if(this.completionFn&&(a||geo.util.isUndefined(a))){this.completionFn.call(this)}};GEarthExtensions.prototype.fx.Animation.prototype.rewind=function(){this.renderFrame(0);this.stop(false)};GEarthExtensions.prototype.fx.Animation.prototype.renderFrame=function(a){this.renderFn.call(this,a)};GEarthExtensions.prototype.fx.TimedAnimation=GEarthExtensions.createClass_([GEarthExtensions.prototype.fx.Animation],function(c,b,a){this.extInstance=arguments.callee.extInstance_;this.duration=c;this.renderFn=b;this.completionFn=a});GEarthExtensions.prototype.fx.TimedAnimation.prototype.renderFrame=function(a){if(a>this.duration){this.renderFn.call(this,this.duration);this.stop();return}this.renderFn.call(this,a)};GEarthExtensions.prototype.fx.bounce=function(f,e){this.fx.rewind(f);e=GEarthExtensions.checkParameters(e,false,{duration:250,startAltitude:GEarthExtensions.ALLOWED,altitude:this.util.getCamera().getAltitude()/5,phase:GEarthExtensions.ALLOWED,repeat:0,dampen:1,callback:GEarthExtensions.ALLOWED});if(!"getGeometry" in f||!f.getGeometry()||f.getGeometry().getType()!="KmlPoint"){throw new Error("Placemark must be a KmlPoint geometry")}var a=f.getGeometry();var d=a.getAltitudeMode();if(d==this.pluginInstance.ALTITUDE_CLAMP_TO_GROUND){a.setAltitude(0);a.setAltitudeMode(this.pluginInstance.ALTITUDE_RELATIVE_TO_GROUND)}if(d==this.pluginInstance.ALTITUDE_CLAMP_TO_SEA_FLOOR){a.setAltitude(0);a.setAltitudeMode(this.pluginInstance.ALTITUDE_RELATIVE_TO_SEA_FLOOR)}var h=a.getAltitude();if("startAltitude" in e){h=e.startAltitude}var c,b;var g=this;c=function(){g.fx.animateProperty(a,"altitude",{duration:e.duration/2,end:h+e.altitude,easing:"out",callback:b})};b=function(){g.fx.animateProperty(a,"altitude",{duration:e.duration/2,end:h,easing:"in",callback:function(){a.setAltitudeMode(d);if(e.repeat>=1){--e.repeat;e.altitude*=e.dampen;e.phase=0;g.fx.bounce(f,e)}else{if(e.callback){e.callback.call(f)}}}})};if(e.phase===1){b=null;c.call()}else{if(e.phase===2){b.call()}else{c.call()}}};GEarthExtensions.prototype.fx.cancel=function(b){var c=this.util.getJsDataValue(b,"_GEarthExtensions_anim")||[];for(var a=0;a<c.length;a++){c[a].stop()}};GEarthExtensions.prototype.fx.rewind=function(b){var c=this.util.getJsDataValue(b,"_GEarthExtensions_anim")||[];for(var a=0;a<c.length;a++){c[a].rewind()}};GEarthExtensions.prototype.fx.animateProperty=function(c,g,j){j=GEarthExtensions.checkParameters(j,false,{duration:500,start:GEarthExtensions.ALLOWED,end:GEarthExtensions.ALLOWED,delta:GEarthExtensions.ALLOWED,easing:"none",callback:GEarthExtensions.ALLOWED});if(typeof j.easing=="string"){j.easing={none:function(k){return k},"in":function(k){return k*k*k},out:function(l){var m=l*l;var k=m*l;return k-3*m+3*l},both:function(l){var m=l*l;var k=m*l;return 6*k*m-15*m*m+10*k}}[j.easing]}var d=g.charAt(0).toUpperCase()+g.substr(1);var e=this;var f=function(){return e.util.callMethod(c,"get"+d)};var a=function(k){return e.util.callMethod(c,"set"+d,k)};if(!isFinite(j.start)&&!isFinite(j.end)){if(!isFinite(j.delta)){j.delta=0}j.start=f();j.end=f()+j.delta}else{if(!isFinite(j.start)){j.start=f()}if(!isFinite(j.end)){j.end=f()}}var b=new this.fx.TimedAnimation(j.duration,function(k){a(j.start+j.easing.call(null,1*k/j.duration)*(j.end-j.start))},function(){var l=e.util.getJsDataValue(c,"_GEarthExtensions_anim");if(l){for(var k=0;k<l.length;k++){if(l[k]==this){l.splice(k,1);break}}if(!l.length){e.util.clearJsDataValue(c,"_GEarthExtensions_anim")}}if(j.callback){j.callback.call(c)}});var h=this.util.getJsDataValue(c,"_GEarthExtensions_anim");if(h){h.push(b)}else{this.util.setJsDataValue(c,"_GEarthExtensions_anim",[b])}b.start();return b};GEarthExtensions.prototype.util={isnamespace_:true};GEarthExtensions.prototype.util.areScreenOverlayXYSwapped_=function(){return this.pluginInstance.getApiVersion()<"1.003"};GEarthExtensions.NAMED_COLORS={aqua:"ffffff00",black:"ff000000",blue:"ffff0000",fuchsia:"ffff00ff",gray:"ff808080",green:"ff008000",lime:"ff00ff00",maroon:"ff000080",navy:"ff800000",olive:"ff008080",purple:"ff800080",red:"ff0000ff",silver:"ffc0c0c0",teal:"ff808000",white:"ffffffff",yellow:"ff00ffff"};GEarthExtensions.prototype.util.parseColor=function(a){if(geo.util.isArray(a)){var b=function(c){return((c.length<2)?"0":"")+c};return b(((a.length>=4)?a[3].toString(16):"ff"))+b(a[2].toString(16))+b(a[1].toString(16))+b(a[0].toString())}else{if(typeof a=="string"){if(a.toLowerCase() in GEarthExtensions.NAMED_COLORS){return GEarthExtensions.NAMED_COLORS[a.toLowerCase()]}if(a.length>7){return a}else{if(a.length>4){return a.replace(/#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i,"ff$3$2$1").toLowerCase()}else{return a.replace(/#?([0-9a-f])([0-9a-f])([0-9a-f])/i,"ff$3$3$2$2$1$1").toLowerCase()}}}}};GEarthExtensions.prototype.util.blendColors=function(b,a,c){if(geo.util.isUndefined(c)||c===null){c=0.5}b=this.util.parseColor(b);a=this.util.parseColor(a);var d=function(f){return((f.length<2)?"0":"")+f};var e=function(g,f){g=parseInt(g,16);f=parseInt(f,16);return d(Math.floor((f-g)*c+g).toString(16))};return e(b.substr(0,2),a.substr(0,2))+e(b.substr(2,2),a.substr(2,2))+e(b.substr(4,2),a.substr(4,2))+e(b.substr(6,2),a.substr(6,2))};(function(){var a={};function c(){var e=[],f="0123456789ABCDEF",d=0;for(d=0;d<36;d++){e[d]=Math.floor(Math.random()*16)}e[14]=4;e[19]=(e[19]&3)|8;for(d=0;d<36;d++){e[d]=f.charAt(e[d])}e[8]=e[13]=e[18]=e[23]="-";return e.join("")}function b(e){for(var d in a){if(a[d].object.equals(e)){return d}}return null}GEarthExtensions.prototype.util.hasJsData=function(d){return b(d)?true:false};GEarthExtensions.prototype.util.clearAllJsData=function(e){var d=b(e);if(d){delete a[d]}};GEarthExtensions.prototype.util.getJsDataValue=function(e,f){var d=b(e);if(d&&f in a[d].data){return a[d].data[f]}return undefined};GEarthExtensions.prototype.util.setJsDataValue=function(e,f,g){var d=b(e);if(!d){d=null;while(!d||d in a){d=c()}a[d]={object:e,data:{}}}a[d].data[f]=g};GEarthExtensions.prototype.util.clearJsDataValue=function(f,g){var d=b(f);if(d&&g in a[d].data){delete a[d].data[g];for(var e in a[d].data){return}this.util.clearAllJsData(f)}}}());(function(){GEarthExtensions.prototype.util.serializeView=function(){var g=this.pluginInstance.getView().copyAsCamera(this.pluginInstance.ALTITUDE_ABSOLUTE);return this.util.encodeCamera_({lat:g.getLatitude(),lng:g.getLongitude(),altitude:g.getAltitude(),heading:g.getHeading(),tilt:g.getTilt(),roll:g.getRoll()})};GEarthExtensions.prototype.util.deserializeView=function(j){var h=this.util.decodeCamera_(j);var g=this.pluginInstance.createCamera("");g.set(h.lat,h.lng,h.altitude,this.pluginInstance.ALTITUDE_ABSOLUTE,h.heading,h.tilt,h.roll);this.pluginInstance.getView().setAbstractView(g)};GEarthExtensions.prototype.util.encodeCamera_=function(h){var g=1073741824;var j=Math.floor(h.altitude*100000);return c([Math.floor(b(h.lat)*100000),Math.floor(b(h.lng)*100000),Math.floor(j/g),(j>=0)?j%g:(g-Math.abs(j)%g),Math.floor(f(h.heading)*100000),Math.floor(f(h.tilt)*100000),Math.floor(f(h.roll)*100000)])};GEarthExtensions.prototype.util.decodeCamera_=function(h){var j=1073741824;var g=a(h);return{lat:g[0]*0.00001,lng:g[1]*0.00001,altitude:(j*g[2]+g[3])*0.00001,heading:g[4]*0.00001,tilt:g[5]*0.00001,roll:g[6]*0.00001}};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function c(g){var j="";for(var h=0;h<g.length;h++){j+=d(g[h])}return j}function f(g){while(g<0){g+=360}return g%360}function b(g){g=f(g);return(g>180)?g-360:g}function d(h){var j=h<<1;if(h<0){j=~(j)}var g="";while(j>=32){g+=e.charAt(32|(j&31));j>>=5}g+=e.charAt(j);return g}function a(m){var j=m.length;var l=0;var n=[];while(l<j){var h;var k=0;var g=0;do{h=e.indexOf(m.charAt(l++));g|=(h&31)<<k;k+=5}while(h>=32);n.push(((g&1)?~(g>>1):(g>>1)))}return n}}());GEarthExtensions.prototype.util.lookAt=function(){this.pluginInstance.getView().setAbstractView(this.dom.buildLookAt.apply(null,arguments))};GEarthExtensions.prototype.util.getLookAt=function(a){if(geo.util.isUndefined(a)){a=this.pluginInstance.ALTITUDE_ABSOLUTE}return this.pluginInstance.getView().copyAsLookAt(a)};GEarthExtensions.prototype.util.getCamera=function(a){if(geo.util.isUndefined(a)){a=this.pluginInstance.ALTITUDE_ABSOLUTE}return this.pluginInstance.getView().copyAsCamera(a)};GEarthExtensions.prototype.util.displayKml=function(b,a){a=a||{};if(a.cacheBuster){b+=(b.match(/\?/)?"&":"?")+"_cacheBuster="+Number(new Date()).toString()}google.earth.fetchKml(this.pluginInstance,b,function(c){if(c){this.pluginInstance.getFeatures().appendChild(c)}})};GEarthExtensions.prototype.util.displayKmlString=function(c,a){var b=this.pluginInstance.parseKml(c);this.pluginInstance.getFeatures().appendChild(b)};GEarthExtensions.prototype.util.batchExecute=function(c,a){var b=this;google.earth.fetchKml(this.pluginInstance,"",function(){c.call(b,a)})};GEarthExtensions.prototype.util.callMethod=function(object,method){var i;var args=[];for(i=2;i<arguments.length;i++){args.push(arguments[i])}if(typeof object[method]=="function"){return object[method].apply(object,args)}else{var reprArgs=[];for(i=0;i<args.length;i++){reprArgs.push("args["+i+"]")}return eval("object."+method+"("+reprArgs.join(",")+")")}};GEarthExtensions.prototype.util.fullCameraControl=function(a){if(a||geo.util.isUndefined(a)){if(this.cameraControlOldProps_){return}this.cameraControlOldProps_={flyToSpeed:this.pluginInstance.getOptions().getFlyToSpeed(),mouseNavEnabled:this.pluginInstance.getOptions().getMouseNavigationEnabled(),navControlVis:this.pluginInstance.getNavigationControl().getVisibility()};this.pluginInstance.getOptions().setFlyToSpeed(this.pluginInstance.SPEED_TELEPORT);this.pluginInstance.getOptions().setMouseNavigationEnabled(false);this.pluginInstance.getNavigationControl().setVisibility(this.pluginInstance.VISIBILITY_HIDE)}else{if(!this.cameraControlOldProps_){return}this.pluginInstance.getOptions().setFlyToSpeed(this.cameraControlOldProps_.flyToSpeed);this.pluginInstance.getOptions().setMouseNavigationEnabled(this.cameraControlOldProps_.mouseNavEnabled);this.pluginInstance.getNavigationControl().setVisibility(this.cameraControlOldProps_.navControlVis);delete this.cameraControlOldProps_}};